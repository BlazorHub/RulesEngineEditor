@page "/"
@using RulesEngine.Models

@*<Workflows />*@
<Workflows EditorRulesEngine="re" @bind-Workflow="Workflows" />

@code{
    private RulesEngine.RulesEngine re;

    private WorkflowRules[] _workflows;
    private WorkflowRules[] Workflows { get { return _workflows; } set { _workflows = value; } }

    enum FooEnum
    {
        bar = 123
    }

    protected override void OnInitialized()
    {
        var settings = new ReSettings
        {
            CustomTypes = new Type[] { typeof(FooEnum) }
        };
        re = new RulesEngine.RulesEngine(null, settings);

        List<WorkflowRules> workFlowRules = new List<WorkflowRules>();
        WorkflowRules workflowRule = new WorkflowRules();
        workflowRule.WorkflowName = "Test Workflow Rule 1";

        List<Rule> rules = new List<Rule>();

        Rule rule = new Rule();
        rule.RuleName = "Test Rule";
        rule.SuccessEvent = "Count is within tolerance.";
        rule.ErrorMessage = "Over expected.";
        rule.Expression = "count < 3";
        rule.RuleExpressionType = RuleExpressionType.LambdaExpression;

        rules.Add(rule);

        workflowRule.Rules = rules;

        workFlowRules.Add(workflowRule);

        Workflows = workFlowRules.ToArray();
    }
}